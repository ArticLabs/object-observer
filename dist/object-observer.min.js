!function(a){"use strict";function b(a){var b;return b=Array.isArray(a)?a.slice():Object.assign({},a)}function c(a){Reflect.ownKeys(a).forEach(function(b){var d=a[b];d&&"object"==typeof d&&c(d)}),q.has(a)?(q.get(a).revoke(),q.delete(a)):console.warn("did not found map for")}function d(a,b){var c;return c="pop"===b?function(){var c,d,e,f;return(c=s.get(a))?(d=a.length-1,e=Reflect.apply(a[b],a,arguments),f=[new m(c.calculatePath().push(d),e)],p(observableData.callbacks,f),e):void console.error("observed expected but not found for "+a)}:"push"===b?function(){var c,d=[];observableData.preventCallbacks=!0,c=Reflect.apply(a[b],a,arguments),g(a,observableData,basePath),observableData.preventCallbacks=!1;for(var e=arguments.length;e>0;e--)d.push(new k(basePath.concat(c-e),a[c-e]));return p(observableData.callbacks,d),c}:"shift"===b?function(){var c,d;return observableData.preventCallbacks=!0,c=Reflect.apply(a[b],a,arguments),g(a,observableData,basePath),observableData.preventCallbacks=!1,d=[new m(basePath.concat(0),c)],p(observableData.callbacks,d),c}:"unshift"===b?function(){var c,d,e=[],f=[];return Array.from(arguments).forEach(function(a,b){var c;a&&"object"==typeof a?(d=proxify(a,observableData,basePath.concat(b)),c=d.proxy):c=a,e.push(c)}),e.forEach(function(a,b){f.push(new k(basePath.concat(b),a))}),c=Reflect.apply(a[b],a,e),g(a,observableData,basePath),p(observableData.callbacks,f),c}:"reverse"===b?function(){var c,d=[];return observableData.preventCallbacks=!0,c=Reflect.apply(a[b],a,arguments),g(a,observableData,basePath),observableData.preventCallbacks=!1,d.push(new n),p(observableData.callbacks,d),c}:"sort"===b?function(){var c,d=[];return observableData.preventCallbacks=!0,c=Reflect.apply(a[b],a,arguments),g(a,observableData,basePath),observableData.preventCallbacks=!1,d.push(new o),p(observableData.callbacks,d),c}:"fill"===b?function(){var c,d,e,f,h=[];d=arguments.length<2?0:arguments[1]<0?a.length+arguments[1]:arguments[1],e=arguments.length<3?a.length:arguments[2]<0?a.length+arguments[2]:arguments[2],f=a.slice(d,e),observableData.preventCallbacks=!0,c=Reflect.apply(a[b],a,arguments),g(a,observableData,basePath),observableData.preventCallbacks=!1;for(var i=d;i<e;i++)a.hasOwnProperty(i-d)?h.push(new l(basePath.concat(i),a[i],f[i-d])):h.push(new k(basePath.concat(i),a[i]));return p(observableData.callbacks,h),c}:"splice"===b?function(){var c,d,e,f,h,i=[];for(observableData.preventCallbacks=!0,d=0===arguments.length?0:arguments[0]<0?a.length+arguments[0]:arguments[0],e=arguments.length<2?a.length-d:arguments[1],f=Math.max(arguments.length-2,0),h=Reflect.apply(a[b],a,arguments),g(a,observableData,basePath),observableData.preventCallbacks=!1,c=0;c<e;c++)c<f?i.push(new l(basePath.concat(d+c),a[d+c],h[c])):i.push(new m(basePath.concat(d+c),h[c]));for(;c<f;c++)i.push(new k(basePath.concat(d+c),a[d+c]));return p(observableData.callbacks,i),h}:Reflect.get(a,b)}function e(a,b,c){var d,e,f=a.hasOwnProperty(b),g=a[b],h=s.get(a),j=t.get(h.root),m=Array.isArray(h.eventsCollector)?h.eventsCollector:[];return d=Reflect.set(a,b,c),j.callbacks.length&&d&&c!==g&&(e=h.path.concat(b),"object"==typeof g&&g&&(r.has(g)&&r.delete(g),q.has(g)&&(q.get(g).revoke(),q.delete(g))),"object"==typeof c&&c&&(a[b]=new i(c,b,h).proxy),f?m.push(new l(e,c,g)):m.push(new k(e,c)),h.preventCallbacks||p(j.callbacks,m)),d}function f(a,b){var c,d,e=a[b],f=s.get(a),g=t.get(f.root),h=Array.isArray(f.eventsCollector)?f.eventsCollector:[];return c=Reflect.deleteProperty(a,b),g.callbacks.length&&c&&("object"==typeof e&&e&&r.has(e)&&r.delete(e),d=f.path.concat(b),h.push(new m(d,e)),f.preventCallbacks||p(g.callbacks,h)),c}function g(a,b){a.forEach(function(c,d){c&&"object"==typeof c&&(a[d]=new i(c,d,b).proxy)})}function h(a,b){Reflect.ownKeys(a).forEach(function(c){a[c]&&"object"==typeof a[c]&&(a[c]=new i(a[c],c,b).proxy)})}function i(a,c,j){var k,l;if(!a||"object"!=typeof a)throw new Error("Observed MUST be created from a non null object origin");if(j&&!c)throw new Error("any non-root (parent-less) Observed MUST have an own path; now parent is "+j+"; key is "+c);if(j&&!(j instanceof i))throw new Error("parent, when supplied, MUST be an instance of Observed");k=b(a),Array.isArray(k)?(g(k,this),l=Proxy.revocable(k,{set:e,get:d,deleteProperty:f})):(h(k,this),l=Proxy.revocable(k,{set:e,deleteProperty:f})),s.set(k,this),Reflect.defineProperty(this,"proxy",{value:l.proxy}),Reflect.defineProperty(this,"parent",{value:j}),Reflect.defineProperty(this,"ownKey",{value:c})}function j(a){function b(a){if(g)throw new TypeError("revoked Observable MAY NOT be observed anymore");if("function"!=typeof a)throw new Error("observer (callback) parameter MUST be a function");h.indexOf(a)<0?h.push(a):console.info("observer (callback) may be bound to an observable only once")}function d(){if(g)throw new TypeError("revoked Observable MAY NOT be unobserved amymore");arguments.length?Array.from(arguments).forEach(function(a){var b=h.indexOf(a);b>=0&&h.splice(b,1)}):h.splice(0,h.length)}function e(){g?console.log("revokation of Observable have an effect only once"):(g=!0,c(proxy))}var f,g=!1,h=[],i=!1;t.set(a,this),Reflect.defineProperty(this,"observe",{value:b}),Reflect.defineProperty(this,"unobserve",{value:d}),Reflect.defineProperty(this,"revoke",{value:e}),Reflect.defineProperty(this,"callbacks",{value:h}),Reflect.defineProperty(this,"eventsCollector",{value:f,writable:!0}),Reflect.defineProperty(this,"preventCallbacks",{value:i,writable:!0})}function k(a,b){Reflect.defineProperty(this,"type",{value:"insert"}),Reflect.defineProperty(this,"path",{value:a}),Reflect.defineProperty(this,"value",{value:b})}function l(a,b,c){Reflect.defineProperty(this,"type",{value:"update"}),Reflect.defineProperty(this,"path",{value:a}),Reflect.defineProperty(this,"value",{value:b}),Reflect.defineProperty(this,"oldValue",{value:c})}function m(a,b){Reflect.defineProperty(this,"type",{value:"delete"}),Reflect.defineProperty(this,"path",{value:a}),Reflect.defineProperty(this,"oldValue",{value:b})}function n(){Reflect.defineProperty(this,"type",{value:"reverse"})}function o(){Reflect.defineProperty(this,"type",{value:"shuffle"})}function p(a,b){for(var c=0;c<a.length;c++)try{a[c](b)}catch(a){console.error(a)}}var q=new WeakMap,r=new WeakMap,s=new WeakMap,t=new WeakMap;Reflect.defineProperty(i.prototype,"root",{get:function(){for(var a=this;a.parent;){if(a.parent===a){logger.error("non trivial case");break}a=a.parent}return a}}),Reflect.defineProperty(i.prototype,"path",{get:function(){for(var a=[],b=this;b.ownKey;)a.push(b.ownKey),b=b.parent;return a.reverse()}}),j.prototype=Object.create(i.prototype),j.prototype.constructor=j,Reflect.defineProperty(j,"from",{value:function(a){if(!a||"object"!=typeof a)throw new Error("observable MAY ONLY be created from non-null object only");if("observe"in a||"unobserve"in a||"revoke"in a)throw new Error('target object MUST NOT have nor own neither inherited properties from the following list: "observe", "unobserve", "revoke"');var b=new i(a);return j.call(b.proxy,b),b.proxy}}),Reflect.defineProperty(a,"Observable",{value:j})}(this);